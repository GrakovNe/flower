<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd">

    <!--                                Simple beans start                                                       -->

    <bean id="smsRequestValidator" class="org.xdcrafts.flower.core.spring.example.sms.SmsRequestValidator"/>

    <bean id="smsAuthorizer" class="org.xdcrafts.flower.core.spring.example.sms.SmsAuthorizer"/>

    <bean id="smsSender" class="org.xdcrafts.flower.core.spring.example.sms.SmsSender"/>

    <!--                                  Simple beans end                                                       -->

    <!--                                  Actions start                                                          -->

    <bean id="smsRequestValidatorAction" class="org.xdcrafts.flower.spring.impl.DefaultActionFactory">
        <constructor-arg name="method" value="smsRequestValidator::validate"/>
    </bean>

    <bean id="smsAuthorizerAction" class="org.xdcrafts.flower.spring.impl.DefaultActionFactory">
        <constructor-arg name="method" value="smsAuthorizer::authorize"/>
    </bean>

    <bean id="smsSenderAction" class="org.xdcrafts.flower.spring.impl.DefaultActionFactory">
        <constructor-arg name="method" value="smsSender::send"/>
    </bean>

    <!--                                  Actions end                                                            -->

    <!--                                  Flows start                                                            -->

    <bean id="smsFlow" class="org.xdcrafts.flower.spring.impl.flows.BasicSyncFlowFactory">
        <constructor-arg name="flow">
            <list>
                <ref bean="smsRequestValidatorAction"/>
                <ref bean="smsAuthorizerAction"/>
                <ref bean="smsSenderAction"/>
            </list>
        </constructor-arg>
    </bean>

    <!--                                  Flows end                                                              -->

    <!--                                  Extensions start                                                       -->

    <bean id="smsExtension" class="org.xdcrafts.flower.spring.impl.extensions.KeywordExtensionFactory">
        <constructor-arg name="keywordValue" value="sms"/>
        <constructor-arg name="action" ref="smsFlow"/>
    </bean>

    <!--                                  Extensions end                                                         -->

    <!--                                  Features start                                                         -->

    <bean id="smsFeature" class="org.xdcrafts.flower.spring.impl.DefaultFeature">
        <constructor-arg name="enabled" value="true"/>
        <constructor-arg name="extensions">
            <map>
                <entry key="smsExtension" value="switcher"/>
            </map>
        </constructor-arg>
    </bean>

    <!--                                  Features end                                                           -->

</beans>

